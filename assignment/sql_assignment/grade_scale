CREATE TABLE GRADEDETAILS (
  EMPLOYEEID INTEGER,
  GRADE TEXT
);

INSERT INTO GRADEDETAILS VALUES 
(1, 'A'),
(2, 'B'),
(3, 'C'),
(4, 'A');

CREATE TABLE LOWERMANAGEMENT (
  SENIORMANAGERID INTEGER,
  LEADMANAGERID INTEGER,
  SENIORMANAGERNAME TEXT,
  SALARY INTEGER
);

INSERT INTO LOWERMANAGEMENT VALUES 
(1,2, 'ARTHUR',140000),
(2,3, 'DAN',140000),
(3,NULL, 'PETE',140000),
(4,3, 'RUSKIN',140000),
(5,4, 'NICK',140000),
(6,5, 'SANDY',140000);


SELECT (SELECT COUNT(*) as EmployeeCountA FROM GRADEDETAILS WHERE GRADE='A'),(SELECT COUNT(*) AS EmployeeCountF FROM GRADEDETAILS WHERE GRADE='F');

SELECT LOWERMANAGEMENT.SENIORMANAGERNAME,LOWERMANAGEMENT.SALARY,RANK() OVER (ORDER BY LOWERMANAGEMENT.SALARY DESC) AS RANKSALARY FROM GRADEDETAILS JOIN LOWERMANAGEMENT ON GRADEDETAILS.EMPLOYEEID  = LOWERMANAGEMENT.SENIORMANAGERID WHERE GRADEDETAILS.GRADE='A'

SELECT L.SENIORMANAGERNAME AS MANAGER_NAME,COUNT(DISTINCT LOWERMANAGEMENT.SENIORMANAGERID) AS EMPLOYEE_COUNT
FROM LOWERMANAGEMENT
JOIN GRADEDETAILS
	ON LOWERMANAGEMENT.LEADMANAGERID = GRADEDETAILS.EMPLOYEEID
JOIN LOWERMANAGEMENT L
	ON  LOWERMANAGEMENT.LEADMANAGERID = L.SENIORMANAGERID
WHERE GRADEDETAILS.GRADE = 'A'
GROUP BY L.SENIORMANAGERNAME
ORDER BY EMPLOYEE_COUNT DESC




